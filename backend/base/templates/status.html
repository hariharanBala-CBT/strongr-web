{% extends 'base_org.html' %}
{% load static %}
{% block content %}
    <link href="{% static './css/status.css' %}" rel="stylesheet" />

    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item"><a href="{% url 'organization_page' %}"><i class="fa fa-home" aria-hidden="true"></i></a></li>
        <li class="breadcrumb-item">Status</li>
    </ol>

    <h1 class="mt-4 mb-4 centered-text">Status</h1>
    <div class="container centered-flex">
        <div class="card2">
            <div class="card-body">
                <p><strong>Logged-in Organization:</strong> {{ organization.organization_name }}</p>
                <p><strong>Status:</strong>
                    {% if organization.status == 1 %}
                        <span class="status-approved">Approved</span>
                    {% elif organization.status == 2 %}
                        <span class="status-pending">Pending</span>
                    {% elif organization.status == 3 %}
                        <span class="status-in-progress">In Progress</span>
                        <p>The Process is ongoing. Service Provider will Contact you after info verification</p>
                    {% elif organization.status == 4 %}
                        <span class="status-cancelled">Cancelled</span>
                        <p><strong>Cancellation Message:</strong> {{ organization.status_description }}</p>
                    {% else %}
                        <span class="status-unknown">Unknown</span>
                        <p>Please Contact the Service Provider.</p>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>

    {% if organization.status != 4 and organization.status == 1 %}
        <div class="container">
            <!-- Tab Navigation -->
            <ul class="nav nav-tabs" id="locationTabs" role="tablist">
                {% for location_detail in location_details %}
                    <li class="nav-item" role="presentation">
                        <button class="nav-link {% if forloop.first %}active{% endif %}" id="locationTab{{ location_detail.location.id }}" data-bs-toggle="tab" data-bs-target="#location{{ location_detail.location.id }}" type="button" role="tab" aria-controls="location{{ location_detail.location.id }}" aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">{{ location_detail.location.address_line_1 }}</button>
                    </li>
                {% endfor %}
            </ul>

            <!-- Tab Content -->
            <div class="tab-content" id="locationTabsContent">
                {% for location_detail in location_details %}
                    <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="location{{ location_detail.location.id }}" role="tabpanel" aria-labelledby="locationTab{{ location_detail.location.id }}">
                        <div class="card">
                            <div class="card-body">
                                <p><strong>Location:</strong> {{ location_detail.location.address_line_1 }}</p>
                                <p><strong>Status:</strong>
                                    {% if location_detail.location.status == 1 %}
                                        <span class="status-approved">Approved</span>
                                    {% elif location_detail.location.status == 2 %}
                                        <span class="status-pending">Pending</span>
                                    {% elif location_detail.location.status == 3 %}
                                        <span class="status-in-progress">In Progress</span>
                                        <p>The Process is ongoing. Service Provider will Contact you after info verification</p>
                                    {% elif location_detail.location.status == 4 %}
                                        <span class="status-cancelled">Cancelled</span>
                                        <p><strong>Cancellation Messages:</strong>{{ location_detail.location.status_description }}</p>
                                    {% else %}
                                        <span class="status-unknown">Unknown</span>
                                        <p>Please Contact the Service Provider.</p>
                                    {% endif %}
                                </p>

                                {% if location_detail.location.status == 2 %}
                                    {% if location_detail.empty_message %}
                                        <p>Suggestion: Please follow below to proceed further</p>
                                        {% for key, message in location_detail.empty_message.items %}
                                            <p class="alert alert-warning">
                                                {% if key == "working_days" %}
                                                    {{ message|safe }},<a href="{% url 'mainview' location_detail.location.pk %}#workingDaysTab"> Add working days</a>
                                                {% elif key == "games" %}
                                                    {{ message|safe }},<a href="{% url 'mainview' location_detail.location.pk %}#gameTab"> Add games</a>
                                                {% elif key == "courts" %}
                                                    {{ message|safe }},<a href="{% url 'mainview' location_detail.location.pk %}#courtTab"> Add courts</a>
                                                {% elif key == "images" %}
                                                    {{ message|safe }},<a href="{% url 'mainview' location_detail.location.pk %}#imageTab"> Add images</a>
                                                {% elif key == "slots" %}
                                                    {{ message|safe }},<a href="{% url 'slot-list' location_detail.location.pk %}#slotsTab"> Add slots</a>
                                                {% elif key == "amenities" %}
                                                    {{ message|safe }},<a href="{% url 'mainview' location_detail.location.pk %}#amenitiesTab"> Add amenities</a>
                                                {% else %}
                                                    {{ message|safe }}
                                                {% endif %}
                                            </p>
                                        {% endfor %}
                                    {% else %}
                                        <p class="alert alert-info">Submit data in <a href="{% url 'preview' %}">preview.</a></p>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
{% endblock %}
